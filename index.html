<!DOCTYPE html>
<html>
<head>
  <title>Absensi Kelas</title>
</head>
<body>

<iframe 
  id="tallyframe"
  src="" 
  loading="lazy"
  width="100%" 
  height="800" 
  frameborder="0">
</iframe>

<script>
document.addEventListener("DOMContentLoaded", () => {
  if (!navigator.geolocation) {
    alert("GPS tidak didukung di perangkat ini.");
    return;
  }

  navigator.geolocation.getCurrentPosition(success, error, {
    enableHighAccuracy: true
  });

  function success(pos) {
    const lat = pos.coords.latitude.toFixed(6);
    const lng = pos.coords.longitude.toFixed(6);
    const acc = pos.coords.accuracy;

    // Kirim lokasi ke URL Tally
    const tallyURL = `https://tally.so/r/q45a5Y?location=${lat},${lng},${acc}`;

    document.getElementById("tallyframe").src = tallyURL;
  }

  function error(err) {
    console.log("GPS error:", err);
    alert("Tidak bisa mendapatkan lokasi. Izinkan akses lokasi.");
  }
});
</script>

</body>
</html>
