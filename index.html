<!DOCTYPE html>
<html>
<head>
  <title>Absensi Kelas</title>
  <script async src="https://tally.so/widgets/embed.js"></script>
</head>
<body>

<iframe data-tally-src="https://tally.so/r/q45a5Y"
  loading="lazy"
  width="100%"
  height="800"
  frameborder="0">
</iframe>

<script>
// Pastikan script menunggu embed siap
window.addEventListener("tally:load", function () {
  if (!navigator.geolocation) {
    console.log("GPS not supported");
    return;
  }

  navigator.geolocation.getCurrentPosition(
    function (pos) {
      const lat = pos.coords.latitude;
      const lng = pos.coords.longitude;
      const acc = pos.coords.accuracy;

      // Kirim ke hidden field 'location' di Tally
      Tally.setAnswer("location", `${lat},${lng},${acc}`);
    },
    function (err) {
      console.log("GPS error:", err);
    }
  );
});
</script>
</body>
</html>
